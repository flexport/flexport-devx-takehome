name: Deploying to Kubernates cluster

on:
  workflow_run:
    workflows: ["Build and publish docker image"]
    types: 
      - completed

jobs:
  create-cluster:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      - name: Create k8s Kind Cluster
        uses: helm/kind-action@v1.4.0
        
      - name: Deploying application on cluster 
        run : kubectl create deployment flexport-app --image=ghcr.io/${{github.repository}}/:main
